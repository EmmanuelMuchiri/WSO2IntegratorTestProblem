<data name="CSVDataService" serviceNamespace="http://example.com">
    <config id="default">
        <property name="org.wso2.ws.dataservice.driver">org.postgresql.Driver</property>
        <property name="org.wso2.ws.dataservice.protocol">jdbc:postgresql://localhost:5432/user_records</property>
        <property name="org.wso2.ws.dataservice.user">postgres</property>
        <property name="org.wso2.ws.dataservice.password">admin</property>
    </config>

    <query id="cacheCSVQuery" useConfig="default">
        <sql>INSERT INTO user_records (name, mobile, country, mobile_length) VALUES (?, ?, ?, ?)</sql>
        <param name="name" ordinal="1" sqlType="STRING" />
        <param name="mobile" ordinal="2" sqlType="STRING" />
        <param name="country" ordinal="3" sqlType="STRING" />
        <param name="mobileLength" ordinal="4" sqlType="INT" />
    </query>

    <query id="retrieveCSVQuery" useConfig="default">
        <sql>SELECT name, mobile, country, LENGTH(mobile) AS mobileLength FROM user_records</sql>
        <result element="CSVDataCollection" rowName="CSVData">
            <element column="name" name="name" xsdType="string" />
            <element column="mobile" name="mobile" xsdType="string" />
            <element column="country" name="country" xsdType="string" />
            <element column="mobileLength" name="mobileLength" xsdType="int" />
        </result>
    </query>
    <property name="messageType" scope="axis2" type="STRING" value="application/json"/>
    <log level="full"/>
    <respond/>
</data>
